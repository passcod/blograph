---
language: node_js
dist: trusty
sudo: false
node_js:
  - "6"
  - "7"
env:
  matrix:
    - RUST=stable
    - RUST=beta
    - RUST=nightly
  global:
    - "PATH=$PATH:$HOME/rust/bin"
matrix:
  allow_failures:
    - env: RUST=nightly
install: echo Running npm install AFTER rustup
before_script:
  - mkdir $HOME/rust
  - "curl -sL https://static.rust-lang.org/rustup.sh -o ~/rustup.sh"
  - "sh ~/rustup.sh --prefix=~/rust --spec=$RUST -y --disable-sudo"
  - rustc --version
  - cargo --version
  - npm install --global npm5
  - npm5 install
script:
  - npm5 test
  - cd native
  - cargo test -p post
after_script:
  - cd native
  - cargo test -p list
